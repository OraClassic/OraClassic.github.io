// ì¹´í…Œê³ ë¦¬ íƒœê·¸ë¥¼ í¬ìŠ¤íŠ¸ ì œëª©ì— ìë™ ì¶”ê°€í•˜ëŠ” ìŠ¤í¬ë¦½íŠ¸
document.addEventListener('DOMContentLoaded', function() {
    // Recent Posts ì„¹ì…˜ì˜ í¬ìŠ¤íŠ¸ ì œëª©ë“¤ ì²˜ë¦¬
    const postTitles = document.querySelectorAll('.archive__item-title a, .list__item .archive__item-title a');
    
    postTitles.forEach(function(titleLink) {
        // URLì—ì„œ ì¹´í…Œê³ ë¦¬ ì¶”ì¶œ (ì˜ˆ: /categories/database/oracle/install/...)
        const href = titleLink.getAttribute('href');
        if (href && href.includes('/categories/')) {
            const pathParts = href.split('/').filter(part => part !== ''); // ë¹ˆ ë¬¸ìì—´ ì œê±°
            const categoryIndex = pathParts.indexOf('categories');
            
                if (categoryIndex !== -1 && pathParts.length > categoryIndex + 2) {
                    // categories ë‹¤ìŒ ë‘ ë²ˆì§¸ì™€ ì„¸ ë²ˆì§¸ ë””ë ‰í† ë¦¬ ì¶”ì¶œ
                    let parentCategory = pathParts[categoryIndex + 1]; // database, os, app ë“±
                    let category = pathParts[categoryIndex + 2]; // oracle, mysql, linux ë“±
                    category = category.charAt(0).toUpperCase() + category.slice(1);
                    
                    // ì´ë¯¸ íƒœê·¸ê°€ ìˆëŠ”ì§€ í™•ì¸
                    if (!titleLink.querySelector('.category-tag')) {
                        // ì¹´í…Œê³ ë¦¬ íƒœê·¸ ìƒì„±
                        const categoryTag = document.createElement('span');
                        categoryTag.className = 'category-tag';
                        categoryTag.setAttribute('data-category', category);
                        categoryTag.setAttribute('data-parent', parentCategory); // ë‘ ë²ˆì§¸ ë””ë ‰í† ë¦¬ ì¶”ê°€
                        
                        // ì¹´í…Œê³ ë¦¬ë³„ ì•„ì´ì½˜ ì„¤ì •
                        let icon = getIconForCategory(category.toLowerCase());
                        categoryTag.innerHTML = icon + ' ' + category;
                    
                    // ì œëª© ì•ì— íƒœê·¸ ì¶”ê°€
                    const originalText = titleLink.textContent;
                    titleLink.textContent = '';
                    titleLink.appendChild(categoryTag);
                    titleLink.appendChild(document.createTextNode(' ' + originalText));
                }
            }
        }
    });

// ì¹´í…Œê³ ë¦¬ë³„ ì•„ì´ì½˜ì„ ë°˜í™˜í•˜ëŠ” í•¨ìˆ˜
function getIconForCategory(category) {
    const iconMap = {
        // ë°ì´í„°ë² ì´ìŠ¤ DBMS
        'oracle': 'ğŸ”´',          // Oracle ë¹¨ê°„ ì›
        'mysql': 'ğŸŸ¡',           // MySQL ë…¸ë€ ì› (ëŒê³ ë˜ ëŒ€ì‹ )
        'postgresql': 'ğŸ”µ',      // PostgreSQL íŒŒë€ ì›
        'postgres': 'ğŸ”µ',        // PostgreSQL ì¶•ì•½
        'mongodb': 'ğŸŸ¢',         // MongoDB ì´ˆë¡ ì›
        'redis': 'ğŸ”´',           // Redis ë¹¨ê°„ìƒ‰
        'sqlite': 'ğŸ”˜',          // SQLite íšŒìƒ‰ ì›
        'mariadb': 'ğŸ”µ',         // MariaDB íŒŒë€ìƒ‰
        'cassandra': 'ğŸŸ¡',       // Cassandra ë…¸ë€ìƒ‰
        'elasticsearch': 'ğŸŸ¡',   // Elasticsearch ë…¸ë€ìƒ‰
        'neo4j': 'ğŸŸ¢',           // Neo4j ì´ˆë¡ìƒ‰
        
        // í´ë¼ìš°ë“œ ì„œë¹„ìŠ¤
        'aws': 'ğŸŸ ',             // AWS ì£¼í™©ìƒ‰
        'azure': 'ğŸ”µ',           // Azure íŒŒë€ìƒ‰
        'gcp': 'ğŸ”´',             // Google Cloud ë¹¨ê°„ìƒ‰
        'docker': 'ğŸ”µ',          // Docker íŒŒë€ìƒ‰
        'kubernetes': 'ğŸ”µ',      // Kubernetes íŒŒë€ìƒ‰
        'k8s': 'ğŸ”µ',             // Kubernetes ì¶•ì•½
        
        // í”„ë¡œê·¸ë˜ë° ì–¸ì–´ (ì‹¤ì œ ë¡œê³  ìƒ‰ìƒ ë°˜ì˜)
        'java': 'ğŸŸ ',            // Java ì£¼í™©ìƒ‰ (ì»¤í”¼ ëŒ€ì‹ )
        'python': 'ğŸŸ¡',          // Python ë…¸ë€ìƒ‰ (ì‹¤ì œ Python ìƒ‰ìƒ)
        'javascript': 'ğŸŸ¡',      // JavaScript ë…¸ë€ìƒ‰
        'js': 'ğŸŸ¡',              // JavaScript ì¶•ì•½
        'typescript': 'ğŸ”µ',      // TypeScript íŒŒë€ìƒ‰
        'ts': 'ğŸ”µ',              // TypeScript ì¶•ì•½
        'go': 'ğŸ”µ',              // Go íŒŒë€ìƒ‰ (ê³ í¼ ëŒ€ì‹ )
        'rust': 'ğŸŸ ',            // Rust ì£¼í™©ìƒ‰
        'php': 'ğŸŸ£',             // PHP ë³´ë¼ìƒ‰
        'ruby': 'ğŸ”´',            // Ruby ë¹¨ê°„ìƒ‰
        'csharp': 'ğŸŸ£',          // C# ë³´ë¼ìƒ‰
        'cpp': 'ğŸ”µ',             // C++ íŒŒë€ìƒ‰
        'c': 'ğŸ”µ',               // C íŒŒë€ìƒ‰
        
        // ì›¹ ê¸°ìˆ 
        'react': 'ğŸ”µ',           // React íŒŒë€ìƒ‰
        'vue': 'ğŸŸ¢',             // Vue.js ì´ˆë¡ìƒ‰
        'angular': 'ğŸ”´',         // Angular ë¹¨ê°„ìƒ‰
        'nodejs': 'ğŸŸ¢',          // Node.js ì´ˆë¡ìƒ‰
        'node': 'ğŸŸ¢',            // Node.js ì¶•ì•½
        'express': 'âš«',         // Express ê²€ì •ìƒ‰
        'django': 'ğŸŸ¢',          // Django ì´ˆë¡ìƒ‰
        'flask': 'âš«',           // Flask ê²€ì •ìƒ‰
        'spring': 'ğŸŸ¢',          // Spring ì´ˆë¡ìƒ‰
        'laravel': 'ğŸ”´',         // Laravel ë¹¨ê°„ìƒ‰
        
        // ìš´ì˜ì²´ì œ
        'linux': 'ğŸ§',           // Linux í­ê·„ (ê·¸ëŒ€ë¡œ ìœ ì§€)
        'ubuntu': 'ğŸŸ ',          // Ubuntu ì£¼í™©ìƒ‰
        'centos': 'ğŸŸ£',          // CentOS ë³´ë¼ìƒ‰
        'redhat': 'ğŸ”´',          // RedHat ë¹¨ê°„ìƒ‰
        'windows': 'ğŸ”µ',         // Windows íŒŒë€ìƒ‰
        'macos': 'âš«',           // macOS ê²€ì •ìƒ‰
        'unix': 'âš«',            // Unix ê²€ì •ìƒ‰
        
        // ë„êµ¬ ë° ê¸°íƒ€
        'git': 'ğŸŸ ',             // Git ì£¼í™©ìƒ‰
        'github': 'âš«',          // GitHub ê²€ì •ìƒ‰
        'gitlab': 'ğŸŸ ',          // GitLab ì£¼í™©ìƒ‰
        'jenkins': 'ğŸ”µ',         // Jenkins íŒŒë€ìƒ‰
        'ansible': 'ğŸ”´',         // Ansible ë¹¨ê°„ìƒ‰
        'terraform': 'ğŸŸ£',       // Terraform ë³´ë¼ìƒ‰
        'nginx': 'ğŸŸ¢',           // Nginx ì´ˆë¡ìƒ‰
        'apache': 'ğŸ”´',          // Apache ë¹¨ê°„ìƒ‰
        'tomcat': 'ğŸŸ¡',          // Tomcat ë…¸ë€ìƒ‰
        'kafka': 'âš«',           // Kafka ê²€ì •ìƒ‰
        'spark': 'ğŸŸ ',           // Apache Spark ì£¼í™©ìƒ‰
        'hadoop': 'ğŸŸ¡',          // Hadoop ë…¸ë€ìƒ‰
        
        // ì„¤ì¹˜/ì„±ëŠ¥/ë³´ì•ˆ ì¹´í…Œê³ ë¦¬
        'install': 'âš™ï¸',         // ì„¤ì¹˜ ê¸°ì–´
        'performance': 'ğŸ“Š',     // ì„±ëŠ¥ ì°¨íŠ¸
        'security': 'ğŸ”’',        // ë³´ì•ˆ ìë¬¼ì‡ 
        'monitoring': 'ğŸ“ˆ',      // ëª¨ë‹ˆí„°ë§ ê·¸ë˜í”„
        'backup': 'ğŸ’¾',          // ë°±ì—… ë””ìŠ¤í¬
        'migration': 'ğŸšš',       // ë§ˆì´ê·¸ë ˆì´ì…˜ íŠ¸ëŸ­
        'troubleshooting': 'ğŸ”§', // ë¬¸ì œí•´ê²° ë„êµ¬
        'optimization': 'ğŸš€',    // ìµœì í™” ë¡œì¼“
        'configuration': 'âš™ï¸',   // êµ¬ì„± ê¸°ì–´
        'deployment': 'ğŸš€',      // ë°°í¬ ë¡œì¼“
    };
    
    return iconMap[category] || 'ğŸ“'; // ê¸°ë³¸ ì•„ì´ì½˜
}
    
    // ê°œë³„ í¬ìŠ¤íŠ¸ í˜ì´ì§€ì˜ ì œëª© ì²˜ë¦¬
    const pageTitle = document.querySelector('.page__title');
    if (pageTitle && window.location.pathname.includes('/categories/')) {
        const pathParts = window.location.pathname.split('/').filter(part => part !== '');
        const categoryIndex = pathParts.indexOf('categories');
        
        if (categoryIndex !== -1 && pathParts.length > categoryIndex + 2) {
            let parentCategory = pathParts[categoryIndex + 1];
            let category = pathParts[categoryIndex + 2];
            category = category.charAt(0).toUpperCase() + category.slice(1);
            
            // ì´ë¯¸ íƒœê·¸ê°€ ìˆëŠ”ì§€ í™•ì¸
            if (!pageTitle.querySelector('.category-tag')) {
                const categoryTag = document.createElement('span');
                categoryTag.className = 'category-tag';
                categoryTag.setAttribute('data-category', category);
                categoryTag.setAttribute('data-parent', parentCategory);
                
                // ì¹´í…Œê³ ë¦¬ë³„ ì•„ì´ì½˜ ì„¤ì •
                let icon = getIconForCategory(category.toLowerCase());
                categoryTag.innerHTML = icon + ' ' + category;
                
                // ì œëª© ì•ì— íƒœê·¸ ì¶”ê°€
                pageTitle.insertBefore(categoryTag, pageTitle.firstChild);
                pageTitle.insertBefore(document.createTextNode(' '), categoryTag.nextSibling);
            }
        }
    }
    
    // í¬ìŠ¤íŠ¸ ë©”íƒ€ë°ì´í„°ì—ì„œ ì¹´í…Œê³ ë¦¬ ì¶”ì¶œí•˜ëŠ” ëŒ€ì•ˆ ë°©ë²•
    const taxonomyItems = document.querySelectorAll('.page__taxonomy-item');
    if (taxonomyItems.length > 0 && pageTitle && !pageTitle.querySelector('.category-tag')) {
        // ë§ˆì§€ë§‰ ì¹´í…Œê³ ë¦¬ë¥¼ ì£¼ ì¹´í…Œê³ ë¦¬ë¡œ ì‚¬ìš©
        const lastCategory = taxonomyItems[taxonomyItems.length - 1];
        const categoryText = lastCategory.textContent.trim();
        
        const categoryTag = document.createElement('span');
        categoryTag.className = 'category-tag';
        categoryTag.setAttribute('data-category', categoryText);
        categoryTag.setAttribute('data-parent', 'fallback'); // ê¸°ë³¸ê°’ ì„¤ì •
        
        // ì¹´í…Œê³ ë¦¬ë³„ ì•„ì´ì½˜ ì„¤ì •
        let icon = getIconForCategory(categoryText.toLowerCase());
        categoryTag.innerHTML = icon + ' ' + categoryText;
        
        pageTitle.insertBefore(categoryTag, pageTitle.firstChild);
        pageTitle.insertBefore(document.createTextNode(' '), categoryTag.nextSibling);
    }
});

// í˜ì´ì§€ ë¡œë“œ í›„ì—ë„ ì‹¤í–‰ (AJAX ë¡œë”© ëŒ€ì‘)
window.addEventListener('load', function() {
    setTimeout(function() {
        // Recent Postsê°€ ë™ì ìœ¼ë¡œ ë¡œë“œë˜ëŠ” ê²½ìš°ë¥¼ ìœ„í•œ ì¬ì‹¤í–‰
        const event = new Event('DOMContentLoaded');
        document.dispatchEvent(event);
    }, 1000);
});
